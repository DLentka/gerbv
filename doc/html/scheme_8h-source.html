<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>gerbv: src/scheme.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8-20040928 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>scheme.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">/* SCHEME.H */</span>
00002 
00003 <span class="preprocessor">#ifndef _SCHEME_H</span>
00004 <span class="preprocessor"></span><span class="preprocessor">#define _SCHEME_H</span>
00005 <span class="preprocessor"></span>
00006 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00007 
00008 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00009 <span class="preprocessor"></span><span class="preprocessor">#include &lt;config.h&gt;</span>
00010 <span class="preprocessor">#endif</span>
00011 <span class="preprocessor"></span>
00012 <span class="comment">/*</span>
00013 <span class="comment"> * Default values for #define'd symbols</span>
00014 <span class="comment"> */</span>
00015 <span class="preprocessor">#ifndef STANDALONE       </span><span class="comment">/* If used as standalone interpreter */</span>
00016 <span class="preprocessor"># define STANDALONE 1</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00018 <span class="preprocessor"></span>
00019 
00020 <span class="preprocessor">#if !defined(_MSC_VER) &amp;&amp; !defined(__MINGW32__)</span>
00021 <span class="preprocessor"></span><span class="preprocessor"># define USE_STRCASECMP 1 </span>
00022 <span class="preprocessor"></span><span class="preprocessor"># define USE_STRLWR 1 </span>
00023 <span class="preprocessor"></span><span class="preprocessor"># define SCHEME_EXPORT</span>
00024 <span class="preprocessor"></span><span class="preprocessor">#else </span>
00025 <span class="preprocessor"></span><span class="preprocessor"># define USE_STRCASECMP 0 </span>
00026 <span class="preprocessor"></span><span class="preprocessor"># define USE_STRLWR 0 </span>
00027 <span class="preprocessor"></span><span class="preprocessor"># if defined(__MINGW32__)</span>
00028 <span class="preprocessor"></span><span class="preprocessor">#  define SCHEME_EXPORT</span>
00029 <span class="preprocessor"></span><span class="preprocessor"># else</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#  ifdef _SCHEME_SOURCE</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#   define SCHEME_EXPORT __declspec(dllexport)</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#  else</span>
00033 <span class="preprocessor"></span><span class="preprocessor">#   define SCHEME_EXPORT __declspec(dllimport)</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#  endif</span>
00035 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
00036 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00037 <span class="preprocessor"></span>
00038 
00039 
00040 <span class="preprocessor">#if USE_NO_FEATURES</span>
00041 <span class="preprocessor"></span><span class="preprocessor"># define USE_MATH 0</span>
00042 <span class="preprocessor"></span><span class="preprocessor"># define USE_CHAR_CLASSIFIERS 0</span>
00043 <span class="preprocessor"></span><span class="preprocessor"># define USE_ASCII_NAMES 0</span>
00044 <span class="preprocessor"></span><span class="preprocessor"># define USE_STRING_PORTS 0</span>
00045 <span class="preprocessor"></span><span class="preprocessor"># define USE_ERROR_HOOK 0</span>
00046 <span class="preprocessor"></span><span class="preprocessor"># define USE_TRACING 0</span>
00047 <span class="preprocessor"></span><span class="preprocessor"># define USE_COLON_HOOK 0</span>
00048 <span class="preprocessor"></span><span class="preprocessor"># define USE_DL 0</span>
00049 <span class="preprocessor"></span><span class="preprocessor"># define USE_PLIST 0</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00051 <span class="preprocessor"></span>
00052 <span class="preprocessor">#if USE_DL</span>
00053 <span class="preprocessor"></span><span class="preprocessor"># define USE_INTERFACE 1</span>
00054 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00055 <span class="preprocessor"></span>
00056 
00057 <span class="preprocessor">#ifndef USE_MATH         </span><span class="comment">/* If math support is needed */</span>
00058 <span class="preprocessor"># define USE_MATH 1</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00060 <span class="preprocessor"></span>
00061 <span class="preprocessor">#ifndef USE_CHAR_CLASSIFIERS  </span><span class="comment">/* If char classifiers are needed */</span>
00062 <span class="preprocessor"># define USE_CHAR_CLASSIFIERS 1</span>
00063 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00064 <span class="preprocessor"></span>
00065 <span class="preprocessor">#ifndef USE_ASCII_NAMES  </span><span class="comment">/* If extended escaped characters are needed */</span>
00066 <span class="preprocessor"># define USE_ASCII_NAMES 1</span>
00067 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00068 <span class="preprocessor"></span>
00069 <span class="preprocessor">#ifndef USE_STRING_PORTS      </span><span class="comment">/* Enable string ports */</span>
00070 <span class="preprocessor"># define USE_STRING_PORTS 1</span>
00071 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00072 <span class="preprocessor"></span>
00073 <span class="preprocessor">#ifndef USE_TRACING</span>
00074 <span class="preprocessor"></span><span class="preprocessor"># define USE_TRACING 1</span>
00075 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00076 <span class="preprocessor"></span>
00077 <span class="preprocessor">#ifndef USE_PLIST</span>
00078 <span class="preprocessor"></span><span class="preprocessor"># define USE_PLIST 0</span>
00079 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00080 <span class="preprocessor"></span>
00081 <span class="comment">/* To force system errors through user-defined error handling (see *error-hook*) */</span>
00082 <span class="preprocessor">#ifndef USE_ERROR_HOOK</span>
00083 <span class="preprocessor"></span><span class="preprocessor"># define USE_ERROR_HOOK 1</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00085 <span class="preprocessor"></span>
00086 <span class="preprocessor">#ifndef USE_COLON_HOOK   </span><span class="comment">/* Enable qualified qualifier */</span>
00087 <span class="preprocessor"># define USE_COLON_HOOK 1</span>
00088 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00089 <span class="preprocessor"></span>
00090 <span class="preprocessor">#ifndef USE_STRCASECMP   </span><span class="comment">/* stricmp for Unix */</span>
00091 <span class="preprocessor"># define USE_STRCASECMP 0</span>
00092 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00093 <span class="preprocessor"></span>
00094 <span class="preprocessor">#ifndef USE_STRLWR</span>
00095 <span class="preprocessor"></span><span class="preprocessor"># define USE_STRLWR 1</span>
00096 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00097 <span class="preprocessor"></span>
00098 <span class="preprocessor">#ifndef STDIO_ADDS_CR    </span><span class="comment">/* Define if DOS/Windows */</span>
00099 <span class="preprocessor"># define STDIO_ADDS_CR 0</span>
00100 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00101 <span class="preprocessor"></span>
00102 <span class="preprocessor">#ifndef INLINE</span>
00103 <span class="preprocessor"></span><span class="preprocessor"># define INLINE</span>
00104 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00105 <span class="preprocessor"></span>
00106 <span class="preprocessor">#ifndef USE_INTERFACE</span>
00107 <span class="preprocessor"></span><span class="preprocessor"># define USE_INTERFACE 0</span>
00108 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00109 <span class="preprocessor"></span>
00110 <span class="keyword">typedef</span> <span class="keyword">struct </span>scheme scheme;
00111 <span class="keyword">typedef</span> <span class="keyword">struct </span>cell *pointer;
00112 
00113 <span class="keyword">typedef</span> <span class="keywordtype">void</span> * (*func_alloc)(size_t);
00114 <span class="keyword">typedef</span> void (*func_dealloc)(<span class="keywordtype">void</span> *);
00115 
00116 <span class="comment">/* num, for generic arithmetic */</span>
00117 <span class="keyword">typedef</span> <span class="keyword">struct </span>num {
00118      <span class="keywordtype">char</span> is_fixnum;
00119      <span class="keyword">union </span>{
00120           <span class="keywordtype">long</span> ivalue;
00121           <span class="keywordtype">double</span> rvalue;
00122      } value;
00123 } num;
00124 
00125 SCHEME_EXPORT scheme *scheme_init_new();
00126 SCHEME_EXPORT scheme *scheme_init_new_custom_alloc(func_alloc malloc, func_dealloc free);
00127 SCHEME_EXPORT <span class="keywordtype">int</span> scheme_init(scheme *sc);
00128 SCHEME_EXPORT <span class="keywordtype">int</span> scheme_init_custom_alloc(scheme *sc, func_alloc, func_dealloc);
00129 SCHEME_EXPORT <span class="keywordtype">void</span> scheme_deinit(scheme *sc);
00130 <span class="keywordtype">void</span> scheme_set_input_port_file(scheme *sc, FILE *fin);
00131 <span class="keywordtype">void</span> scheme_set_input_port_string(scheme *sc, <span class="keywordtype">char</span> *start, <span class="keywordtype">char</span> *past_the_end);
00132 SCHEME_EXPORT <span class="keywordtype">void</span> scheme_set_output_port_file(scheme *sc, FILE *fin);
00133 <span class="keywordtype">void</span> scheme_set_output_port_string(scheme *sc, <span class="keywordtype">char</span> *start, <span class="keywordtype">char</span> *past_the_end);
00134 SCHEME_EXPORT <span class="keywordtype">void</span> scheme_load_file(scheme *sc, FILE *fin);
00135 SCHEME_EXPORT <span class="keywordtype">void</span> scheme_load_string(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd);
00136 <span class="keywordtype">void</span> scheme_apply0(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *procname);
00137 SCHEME_EXPORT pointer scheme_apply1(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *procname, pointer);
00138 <span class="keywordtype">void</span> scheme_set_external_data(scheme *sc, <span class="keywordtype">void</span> *p);
00139 SCHEME_EXPORT <span class="keywordtype">void</span> scheme_define(scheme *sc, pointer env, pointer symbol, pointer value);
00140 
00141 <span class="keyword">typedef</span> pointer (*foreign_func)(scheme *, pointer);
00142 
00143 pointer _cons(scheme *sc, pointer a, pointer b, <span class="keywordtype">int</span> immutable);
00144 pointer mk_integer(scheme *sc, <span class="keywordtype">long</span> num);
00145 pointer mk_real(scheme *sc, <span class="keywordtype">double</span> num);
00146 pointer mk_symbol(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00147 pointer gensym(scheme *sc);
00148 pointer mk_string(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *str);
00149 pointer mk_counted_string(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">int</span> len);
00150 pointer mk_character(scheme *sc, <span class="keywordtype">int</span> c);
00151 pointer mk_foreign_func(scheme *sc, foreign_func f);
00152 <span class="keywordtype">void</span> putstr(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *s);
00153 
00154 
00155 <span class="preprocessor">#if USE_INTERFACE</span>
00156 <span class="preprocessor"></span><span class="keyword">struct </span>scheme_interface {
00157   void (*scheme_define)(scheme *sc, pointer env, pointer symbol, pointer value);
00158   pointer (*cons)(scheme *sc, pointer a, pointer b);
00159   pointer (*immutable_cons)(scheme *sc, pointer a, pointer b);
00160   pointer (*mk_integer)(scheme *sc, <span class="keywordtype">long</span> num);
00161   pointer (*mk_real)(scheme *sc, <span class="keywordtype">double</span> num);
00162   pointer (*mk_symbol)(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00163   pointer (*gensym)(scheme *sc);
00164   pointer (*mk_string)(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *str);
00165   pointer (*mk_counted_string)(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">int</span> len);
00166   pointer (*mk_character)(scheme *sc, <span class="keywordtype">int</span> c);
00167   pointer (*mk_vector)(scheme *sc, <span class="keywordtype">int</span> len);
00168   pointer (*mk_foreign_func)(scheme *sc, foreign_func f);
00169   void (*putstr)(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *s);
00170   void (*putcharacter)(scheme *sc, <span class="keywordtype">int</span> c);
00171   
00172   int (*is_string)(pointer p);
00173   <span class="keywordtype">char</span> *(*string_value)(pointer p);
00174   int (*is_number)(pointer p);
00175   num (*nvalue)(pointer p);
00176   long (*ivalue)(pointer p);
00177   double (*rvalue)(pointer p);
00178   int (*is_integer)(pointer p);
00179   int (*is_real)(pointer p);
00180   int (*is_character)(pointer p);
00181   long (*charvalue)(pointer p);
00182   int (*is_vector)(pointer p);
00183   long (*vector_length)(pointer vec);
00184   void (*fill_vector)(pointer vec, pointer elem);
00185   pointer (*vector_elem)(pointer vec, <span class="keywordtype">int</span> ielem);
00186   pointer (*set_vector_elem)(pointer vec, <span class="keywordtype">int</span> ielem, pointer newel);
00187   int (*is_port)(pointer p);
00188   
00189   int (*is_pair)(pointer p);
00190   pointer (*pair_car)(pointer p);
00191   pointer (*pair_cdr)(pointer p);
00192   pointer (*set_car)(pointer p, pointer q);
00193   pointer (*set_cdr)(pointer p, pointer q);
00194 
00195   int (*is_symbol)(pointer p);
00196   <span class="keywordtype">char</span> *(*symname)(pointer p);
00197   
00198   int (*is_syntax)(pointer p);
00199   int (*is_proc)(pointer p);
00200   int (*is_foreign)(pointer p);
00201   <span class="keywordtype">char</span> *(*syntaxname)(pointer p);
00202   int (*is_closure)(pointer p);
00203   int (*is_macro)(pointer p);
00204   pointer (*closure_code)(pointer p);
00205   pointer (*closure_env)(pointer p);
00206 
00207   int (*is_continuation)(pointer p);
00208   int (*is_promise)(pointer p);
00209   int (*is_environment)(pointer p);
00210   int (*is_immutable)(pointer p);
00211   void (*setimmutable)(pointer p);
00212   void (*load_file)(scheme *sc, FILE *fin);
00213   void (*load_string)(scheme *sc, <span class="keyword">const</span> <span class="keywordtype">char</span> *input);
00214 };
00215 <span class="preprocessor">#endif</span>
00216 <span class="preprocessor"></span>
00217 <span class="preprocessor">#endif</span>
00218 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Oct 13 16:09:21 2004 for gerbv by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.8-20040928 </small></address>
</body>
</html>
