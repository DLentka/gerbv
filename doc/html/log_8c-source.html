<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>gerbv: src/log.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8-20040928 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>log.c</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * gEDA - GNU Electronic Design Automation</span>
00003 <span class="comment"> * This file is a part of gerbv.</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> *   Copyright (C) 2000-2002 Stefan Petersen (spe@stacken.kth.se)</span>
00006 <span class="comment"> *</span>
00007 <span class="comment"> * $Id$</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * Contributed by Dino Ghilardi &lt;dino.ghilardi@ieee.org&gt; </span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
00012 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00013 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00014 <span class="comment"> * (at your option) any later version.</span>
00015 <span class="comment"> *</span>
00016 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
00017 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00018 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00019 <span class="comment"> * GNU General Public License for more details.</span>
00020 <span class="comment"> *</span>
00021 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00022 <span class="comment"> * along with this program; if not, write to the Free Software</span>
00023 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111 USA</span>
00024 <span class="comment"> */</span>
00025 
00026 
00027 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00028 <span class="preprocessor"></span><span class="preprocessor">#include &lt;config.h&gt;</span>
00029 <span class="preprocessor">#endif</span>
00030 <span class="preprocessor"></span>
00031 <span class="preprocessor">#ifdef HAVE_UNISTD_H</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#include &lt;unistd.h&gt;</span>
00033 <span class="preprocessor">#endif</span>
00034 <span class="preprocessor"></span>
00035 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00036 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00037 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00038 <span class="preprocessor">#include &lt;sys/stat.h&gt;</span>
00039 <span class="preprocessor">#include &lt;string.h&gt;</span>
00040 
00041 <span class="preprocessor">#ifdef USE_GTK2</span>
00042 <span class="preprocessor"></span><span class="comment">/* </span>
00043 <span class="comment"> * XXX GtkText is deprecated in GTK+ 2.0 so this needs a </span>
00044 <span class="comment"> * more permanent solution</span>
00045 <span class="comment"> */</span>
00046 <span class="preprocessor">#define GTK_ENABLE_BROKEN 1</span>
00047 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00048 <span class="preprocessor"></span>
00049 <span class="preprocessor">#include &lt;gdk/gdkkeysyms.h&gt;</span>
00050 
00051 <span class="preprocessor">#include "log.h"</span>
00052 <span class="preprocessor">#include "color.h"</span>
00053 <span class="preprocessor">#include "gerbv_screen.h"</span>
00054 <span class="preprocessor">#include "setup.h"</span>
00055 
00056 
00057 <span class="comment">/*  #define SAVE_LOGFILE */</span>
00058 
00059 <span class="keyword">static</span> GtkWidget *create_LogWindow(<span class="keywordtype">void</span>);
00060 <span class="preprocessor">#ifdef SAVE_LOGFILE</span>
00061 <span class="preprocessor"></span><span class="keyword">static</span> GtkWidget *create_LogFileSelection(<span class="keywordtype">void</span>);
00062 <span class="preprocessor">#endif</span>
00063 <span class="preprocessor"></span>
00064 <span class="comment">/* XXX PHONY PROTOTYPE MUST FIX */</span>
00065 GtkWidget *lookup_widget (GtkWidget * widget, <span class="keyword">const</span> gchar * widget_name);
00066 
00067 <span class="comment">/* CallBack Functions prototypes </span>
00068 <span class="comment"> * (cut-n-pasted from Glade-generated file callbacks.h)</span>
00069 <span class="comment"> */</span>
00070 <span class="keyword">static</span> <span class="keywordtype">void</span> clear_log_button_clicked(GtkButton *button, gpointer user_data);
00071 <span class="keyword">static</span> <span class="keywordtype">void</span> LogWindow_destroy(GtkObject *object, gpointer user_data);
00072 <span class="keyword">static</span> <span class="keywordtype">void</span> close_log_button_clicked(GtkButton *button, gpointer user_data);
00073 <span class="preprocessor">#ifdef SAVE_LOGFILE</span>
00074 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> logfile_select_ok_button_clicked(GtkButton *button, gpointer user_data);
00075 <span class="keyword">static</span> <span class="keywordtype">void</span> logfile_cancel_button_clicked(GtkButton *button, gpointer user_data);
00076 <span class="keyword">static</span> <span class="keywordtype">void</span> save_log_button_clicked(GtkButton *button, gpointer user_data);
00077 <span class="preprocessor">#endif</span>
00078 <span class="preprocessor"></span>
00079 <span class="keyword">static</span> GtkWidget*
00080 create_LogWindow (<span class="keywordtype">void</span>)
00081 {
00082     GtkWidget *LogWindow;
00083     GtkWidget *vbox1;
00084     GtkWidget *scrolledwindow1;
00085     GtkWidget *logtxt;
00086     GtkWidget *hbox1;
00087     GtkWidget *clear_log_button;
00088 <span class="preprocessor">#ifdef SAVE_LOGFILE</span>
00089 <span class="preprocessor"></span>    GtkWidget *save_log_button;
00090 <span class="preprocessor">#endif</span>
00091 <span class="preprocessor"></span>    GtkWidget *close_log_button;
00092     
00093     LogWindow = gtk_window_new (GTK_WINDOW_TOPLEVEL);
00094     gtk_object_set_data (GTK_OBJECT (LogWindow), <span class="stringliteral">"LogWindow"</span>, LogWindow);
00095     gtk_window_set_title (GTK_WINDOW (LogWindow), <span class="stringliteral">"Log Messages"</span>);
00096     gtk_window_set_default_size(GTK_WINDOW(LogWindow), 600, 100);
00097     
00098     vbox1 = gtk_vbox_new (FALSE, 0);
00099     gtk_widget_ref (vbox1);
00100     gtk_object_set_data_full (GTK_OBJECT (LogWindow), <span class="stringliteral">"vbox1"</span>, vbox1,
00101                            (GtkDestroyNotify) gtk_widget_unref);
00102     gtk_widget_show (vbox1);
00103     gtk_container_add (GTK_CONTAINER (LogWindow), vbox1);
00104     
00105     scrolledwindow1 = gtk_scrolled_window_new (NULL, NULL);
00106     gtk_widget_ref (scrolledwindow1);
00107     gtk_object_set_data_full (GTK_OBJECT (LogWindow), <span class="stringliteral">"scrolledwindow1"</span>, 
00108                            scrolledwindow1,
00109                            (GtkDestroyNotify) gtk_widget_unref);
00110     gtk_widget_show (scrolledwindow1);
00111     gtk_box_pack_start (GTK_BOX (vbox1), scrolledwindow1, TRUE, TRUE, 0);
00112     gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow1), 
00113                                 GTK_POLICY_NEVER, GTK_POLICY_ALWAYS);
00114     
00115     logtxt = gtk_text_new (NULL, NULL);
00116     gtk_widget_ref (logtxt);
00117     gtk_object_set_data_full (GTK_OBJECT (LogWindow), <span class="stringliteral">"logtxt"</span>, logtxt,
00118                            (GtkDestroyNotify) gtk_widget_unref);
00119     gtk_widget_show (logtxt);
00120     gtk_container_add (GTK_CONTAINER (scrolledwindow1), logtxt);
00121     
00122     hbox1 = gtk_hbox_new (FALSE, 0);
00123     gtk_widget_ref (hbox1);
00124     gtk_object_set_data_full (GTK_OBJECT (LogWindow), <span class="stringliteral">"hbox1"</span>, hbox1,
00125                             (GtkDestroyNotify) gtk_widget_unref);
00126     gtk_widget_show (hbox1);
00127     gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, TRUE, 0);
00128     gtk_widget_set_usize (hbox1, -2, 24);
00129 
00130     clear_log_button = gtk_button_new_with_label (<span class="stringliteral">"Clear log"</span>);
00131     gtk_widget_ref (clear_log_button);
00132     gtk_object_set_data_full (GTK_OBJECT (LogWindow), <span class="stringliteral">"clear_log_button"</span>, 
00133                            clear_log_button,
00134                            (GtkDestroyNotify) gtk_widget_unref);
00135     gtk_widget_show (clear_log_button);
00136     gtk_box_pack_start (GTK_BOX (hbox1), clear_log_button, TRUE, TRUE, 0);
00137     gtk_widget_set_usize (clear_log_button, -2, 24);
00138 <span class="preprocessor">#ifdef SAVE_LOGFILE</span>
00139 <span class="preprocessor"></span>    save_log_button = gtk_button_new_with_label (<span class="stringliteral">"Save Log to File"</span>);
00140     gtk_widget_ref (save_log_button);
00141     gtk_object_set_data_full (GTK_OBJECT (LogWindow), <span class="stringliteral">"save_log_button"</span>, 
00142                            save_log_button,
00143                            (GtkDestroyNotify) gtk_widget_unref);
00144     gtk_widget_show (save_log_button);
00145     gtk_box_pack_start (GTK_BOX (hbox1), save_log_button, TRUE, TRUE, 0);
00146 <span class="preprocessor">#endif</span>
00147 <span class="preprocessor"></span>    close_log_button = gtk_button_new_with_label (<span class="stringliteral">"Close"</span>);
00148     gtk_widget_ref (close_log_button);
00149     gtk_object_set_data_full (GTK_OBJECT (LogWindow), <span class="stringliteral">"close_log_button"</span>, 
00150                            close_log_button,
00151                            (GtkDestroyNotify) gtk_widget_unref);
00152     gtk_widget_show (close_log_button);
00153     gtk_box_pack_start (GTK_BOX (hbox1), close_log_button, TRUE, TRUE, 0);
00154     gtk_widget_set_usize (close_log_button, -2, 24);
00155     
00156     gtk_signal_connect (GTK_OBJECT (LogWindow), <span class="stringliteral">"destroy"</span>,
00157                      GTK_SIGNAL_FUNC (LogWindow_destroy),
00158                      NULL);
00159     gtk_signal_connect (GTK_OBJECT (clear_log_button), <span class="stringliteral">"clicked"</span>,
00160                      GTK_SIGNAL_FUNC (clear_log_button_clicked),
00161                      NULL);
00162 <span class="preprocessor">#ifdef SAVE_LOGFILE</span>
00163 <span class="preprocessor"></span>    gtk_signal_connect (GTK_OBJECT (save_log_button), <span class="stringliteral">"clicked"</span>,
00164                      GTK_SIGNAL_FUNC (save_log_button_clicked),
00165                      NULL);
00166 <span class="preprocessor">#endif</span>
00167 <span class="preprocessor"></span>    gtk_signal_connect (GTK_OBJECT (close_log_button), <span class="stringliteral">"clicked"</span>,
00168                      GTK_SIGNAL_FUNC (close_log_button_clicked),
00169                      NULL);
00170     
00171     <span class="keywordflow">return</span> LogWindow;
00172 } <span class="comment">/* create_LogWindow */</span>
00173 
00174 
00175 <span class="preprocessor">#ifdef SAVE_LOGFILE</span>
00176 <span class="preprocessor"></span><span class="keyword">static</span> GtkWidget *
00177 create_LogFileSelection(<span class="keywordtype">void</span>)
00178 {
00179     GtkWidget *LogFileSelection;
00180     GtkWidget *logfile_select_ok_button1;
00181     GtkWidget *logfile_cancel_button;
00182     
00183     LogFileSelection = gtk_file_selection_new(<span class="stringliteral">"Select Log file to write"</span>);
00184     gtk_object_set_data(GTK_OBJECT(LogFileSelection), <span class="stringliteral">"LogFileSelection"</span>,
00185                      LogFileSelection);
00186     gtk_container_set_border_width(GTK_CONTAINER(LogFileSelection), 10);
00187     
00188     logfile_select_ok_button1 =
00189        GTK_FILE_SELECTION(LogFileSelection)-&gt;ok_button;
00190     gtk_object_set_data(GTK_OBJECT(LogFileSelection),
00191                      <span class="stringliteral">"logfile_select_ok_button1"</span>,
00192                      logfile_select_ok_button1);
00193     gtk_widget_show(logfile_select_ok_button1);
00194     GTK_WIDGET_SET_FLAGS(logfile_select_ok_button1, GTK_CAN_DEFAULT);
00195     
00196     logfile_cancel_button =
00197        GTK_FILE_SELECTION(LogFileSelection)-&gt;cancel_button;
00198     gtk_object_set_data(GTK_OBJECT(LogFileSelection),
00199                      <span class="stringliteral">"logfile_cancel_button"</span>, logfile_cancel_button);
00200     gtk_widget_show(logfile_cancel_button);
00201     GTK_WIDGET_SET_FLAGS(logfile_cancel_button, GTK_CAN_DEFAULT);
00202     
00203     gtk_signal_connect(GTK_OBJECT(logfile_select_ok_button1), <span class="stringliteral">"clicked"</span>,
00204                      GTK_SIGNAL_FUNC(logfile_select_ok_button_clicked),
00205                      NULL);
00206     gtk_signal_connect(GTK_OBJECT(logfile_cancel_button), <span class="stringliteral">"clicked"</span>,
00207                      GTK_SIGNAL_FUNC(logfile_cancel_button_clicked),
00208                      NULL);
00209     
00210     <span class="keywordflow">return</span> LogFileSelection;
00211 } <span class="comment">/* create_LogFileSelection */</span>
00212 <span class="preprocessor">#endif</span>
00213 <span class="preprocessor"></span>
00214 
00215 <span class="keywordtype">void</span>
00216 gerbv_console_log_handler(<span class="keyword">const</span> gchar *log_domain,
00217                        GLogLevelFlags log_level,
00218                        <span class="keyword">const</span> gchar *message, 
00219                        gpointer user_data)
00220 {
00221 
00222     fprintf(stderr, <span class="stringliteral">"%s"</span>, message);
00223 } <span class="comment">/* gerbv_console_log_handler */</span>
00224 
00225 
00226 <span class="keywordtype">void</span>
00227 gerbv_gtk_log_handler(<span class="keyword">const</span> gchar *log_domain,
00228                     GLogLevelFlags log_level,
00229                     <span class="keyword">const</span> gchar *message, 
00230                     gpointer user_data)
00231 {
00232     GtkWidget *LogText = NULL;
00233     GdkColor textfgcolor;
00234     
00235     
00236     <span class="comment">/* If the log window does not exist, create it  */</span>
00237     <span class="keywordflow">if</span>(<a class="code" href="gerbv_8c.html#a0">screen</a>.win.log == NULL){
00238        <a class="code" href="gerbv_8c.html#a0">screen</a>.win.log = create_LogWindow();
00239     }
00240     gtk_widget_show(<a class="code" href="gerbv_8c.html#a0">screen</a>.win.log);
00241     LogText =(GtkWidget *)lookup_widget((GtkWidget *)<a class="code" href="gerbv_8c.html#a0">screen</a>.win.log, <span class="stringliteral">"logtxt"</span>);
00242 
00243     <span class="comment">/*</span>
00244 <span class="comment">     * Print text to logfile if we have demanded it.</span>
00245 <span class="comment">     */</span>
00246     <span class="keywordflow">if</span>(setup.log.to_file) { <span class="comment">/* Append log message to file if required */</span>
00247        FILE *fd = NULL;
00248        fd = fopen(setup.log.filename, <span class="stringliteral">"a"</span>);
00249        <span class="keywordflow">if</span>(fd) {
00250            <span class="keywordflow">switch</span>(log_level &amp; G_LOG_LEVEL_MASK) {
00251            <span class="keywordflow">case</span> G_LOG_LEVEL_ERROR:
00252               fprintf(fd, <span class="stringliteral">"ERROR    :"</span>);
00253               <span class="keywordflow">break</span>;
00254            <span class="keywordflow">case</span> G_LOG_LEVEL_CRITICAL:
00255               fprintf(fd, <span class="stringliteral">"CRITICAL :"</span>);
00256               <span class="keywordflow">break</span>;
00257            <span class="keywordflow">case</span> G_LOG_LEVEL_WARNING:
00258               fprintf(fd, <span class="stringliteral">"WARNING  :"</span>);
00259               <span class="keywordflow">break</span>;
00260            <span class="keywordflow">case</span> G_LOG_LEVEL_MESSAGE:
00261               fprintf(fd, <span class="stringliteral">"MESSAGE  :"</span>);
00262               <span class="keywordflow">break</span>;
00263            <span class="keywordflow">case</span> G_LOG_LEVEL_INFO:
00264               fprintf(fd, <span class="stringliteral">"INFO     :"</span>);
00265               <span class="keywordflow">break</span>;
00266            <span class="keywordflow">case</span> G_LOG_LEVEL_DEBUG:
00267               fprintf(fd, <span class="stringliteral">"DEBUG    :"</span>);
00268               <span class="keywordflow">break</span>;
00269            <span class="keywordflow">default</span>:
00270               fprintf(fd, <span class="stringliteral">"Unhandled[%d]:"</span>, (<span class="keywordtype">int</span>)log_level);
00271               <span class="keywordflow">break</span>;
00272            }
00273            fprintf(fd, <span class="stringliteral">"%s\n"</span>, message);
00274            fclose(fd);
00275        } <span class="keywordflow">else</span> {
00276            <span class="comment">/*could not open file... do something else??? </span>
00277 <span class="comment">             P.S: do not send a warning using g_warning or whatever </span>
00278 <span class="comment">             from here, or a recursion condition</span>
00279 <span class="comment">             will happen and the program will crash. */</span>
00280            
00281            gdk_color_parse(<span class="stringliteral">"red"</span>, &amp;textfgcolor);
00282            <span class="comment">/* allocate text foreground color */</span>
00283            gdk_colormap_alloc_color(gdk_colormap_get_system(), &amp;textfgcolor,
00284                                  FALSE, TRUE);
00285            gtk_text_insert(GTK_TEXT(LogText), NULL, &amp;textfgcolor, NULL,
00286                          <span class="stringliteral">"log.c: Could not open log file for writing\n"</span>,
00287                          -1);
00288            
00289        }
00290     }
00291     
00292     <span class="comment">/* now select a different color for a different message. </span>
00293 <span class="comment">     * See rgb.txt for the color names definition </span>
00294 <span class="comment">     * (on my PC it is on /usr/X11R6/lib/X11/rgb.txt) */</span>
00295     <span class="keywordflow">switch</span>(log_level &amp; G_LOG_LEVEL_MASK) {
00296     <span class="keywordflow">case</span> G_LOG_LEVEL_ERROR:
00297        <span class="comment">/* a message of this kind aborts the application calling abort() */</span>
00298        gdk_color_parse(<span class="stringliteral">"red"</span>, &amp;textfgcolor);
00299        <span class="keywordflow">break</span>;
00300     <span class="keywordflow">case</span> G_LOG_LEVEL_CRITICAL:
00301        gdk_color_parse(<span class="stringliteral">"red"</span>, &amp;textfgcolor);
00302        <span class="keywordflow">break</span>;
00303     <span class="keywordflow">case</span> G_LOG_LEVEL_WARNING:
00304        gdk_color_parse(<span class="stringliteral">"darkred"</span>, &amp;textfgcolor);
00305        <span class="keywordflow">break</span>;
00306     <span class="keywordflow">case</span> G_LOG_LEVEL_MESSAGE:
00307        gdk_color_parse(<span class="stringliteral">"darkblue"</span>, &amp;textfgcolor);
00308        <span class="keywordflow">break</span>;
00309     <span class="keywordflow">case</span> G_LOG_LEVEL_INFO:
00310        gdk_color_parse(<span class="stringliteral">"darkgreen"</span>, &amp;textfgcolor);
00311        <span class="keywordflow">break</span>;
00312     <span class="keywordflow">case</span> G_LOG_LEVEL_DEBUG:
00313        gdk_color_parse(<span class="stringliteral">"SaddleBrown"</span>, &amp;textfgcolor);
00314        <span class="keywordflow">break</span>;
00315     <span class="keywordflow">default</span>:
00316        gdk_color_parse(<span class="stringliteral">"black"</span>, &amp;textfgcolor);
00317        <span class="keywordflow">break</span>;
00318     }
00319 
00320     <span class="comment">/*</span>
00321 <span class="comment">     * Fatal aborts application. We will try to get the message out anyhow.</span>
00322 <span class="comment">     */</span>
00323     <span class="keywordflow">if</span> (log_level &amp; G_LOG_FLAG_FATAL)
00324        fprintf(stderr, <span class="stringliteral">"Fatal error : %s\n"</span>, message);
00325 
00326     <span class="comment">/* allocate text foreground color */</span>
00327     gdk_colormap_alloc_color(gdk_colormap_get_system(), &amp;textfgcolor,
00328                           FALSE, TRUE);
00329 
00330     <span class="comment">/* if needed can be used also a different background color for the text</span>
00331 <span class="comment">     * (see gtk_text_insert documentation)</span>
00332 <span class="comment">     * gtk_text_insert(GtkText *text, GdkFont *font, GdkColor *fore, </span>
00333 <span class="comment">     * GdkColor *back, const char *chars, gint length);</span>
00334 <span class="comment">     */</span>
00335     gtk_text_insert(GTK_TEXT(LogText), NULL, &amp;textfgcolor, NULL, message, -1);
00336     
00337     gdk_colormap_free_colors(gdk_colormap_get_system(), &amp;textfgcolor, 1);
00338 }
00339 
00340 
00341 <span class="keyword">static</span> <span class="keywordtype">void</span>
00342 clear_log_button_clicked(GtkButton *button, gpointer user_data)
00343 {
00344     GtkWidget *LogText = NULL;
00345     LogText =(GtkWidget *)lookup_widget((GtkWidget *)<a class="code" href="gerbv_8c.html#a0">screen</a>.win.log, <span class="stringliteral">"logtxt"</span>);
00346     gtk_text_backward_delete(GTK_TEXT(LogText),
00347                           gtk_text_get_length(GTK_TEXT(LogText)));
00348 } <span class="comment">/* clear_log_button_clicked */</span>
00349 
00350 
00351 <span class="keyword">static</span> <span class="keywordtype">void</span>
00352 LogWindow_destroy(GtkObject *object, gpointer user_data)
00353 {
00354     gtk_widget_destroy(<a class="code" href="gerbv_8c.html#a0">screen</a>.win.log);
00355     <a class="code" href="gerbv_8c.html#a0">screen</a>.win.log = NULL;
00356 } <span class="comment">/* LogWindow_destroy */</span>
00357 
00358 
00359 <span class="keyword">static</span> <span class="keywordtype">void</span>
00360 close_log_button_clicked(GtkButton *button, gpointer user_data)
00361 {
00362     gtk_widget_hide(GTK_WIDGET(<a class="code" href="gerbv_8c.html#a0">screen</a>.win.log));
00363 } <span class="comment">/* close_log_button_clicked */</span>
00364 
00365 
00366 <span class="preprocessor">#ifdef SAVE_LOGFILE</span>
00367 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span>
00368 logfile_select_ok_button_clicked(GtkButton *button, gpointer user_data)
00369 {
00370     GtkFileSelection *FileSelection = NULL;
00371     <span class="keywordtype">char</span> *filename;
00372 
00373     FileSelection =
00374        (GtkFileSelection *)lookup_widget(GTK_WIDGET(button),
00375                                      <span class="stringliteral">"LogFileSelection"</span>);
00376 
00377     filename = gtk_file_selection_get_filename(FileSelection);
00378     printf(<span class="stringliteral">"Log filename:%s\n"</span>, filename);
00379 
00380     gtk_widget_destroy(GTK_WIDGET(FileSelection));
00381 } <span class="comment">/* logfile_select_ok_button_clicked */</span>
00382 
00383 
00384 <span class="keyword">static</span> <span class="keywordtype">void</span>
00385 logfile_cancel_button_clicked(GtkButton *button, gpointer user_data)
00386 {
00387     GtkWidget *FileSelection = NULL;
00388     FileSelection = lookup_widget(GTK_WIDGET(button), <span class="stringliteral">"LogFileSelection"</span>);
00389     gtk_widget_destroy(FileSelection);
00390 } <span class="comment">/* logfile_cancel_button_clicked */</span>
00391 
00392 
00393 <span class="keyword">static</span> <span class="keywordtype">void</span>
00394 save_log_button_clicked(GtkButton *button, gpointer user_data)
00395 {
00396     GtkWidget *FileSelection = NULL;
00397     FileSelection = create_LogFileSelection();
00398     gtk_widget_show(FileSelection);
00399 } <span class="comment">/* save_log_button_clicked */</span>
00400 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Oct 13 16:09:19 2004 for gerbv by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.8-20040928 </small></address>
</body>
</html>
